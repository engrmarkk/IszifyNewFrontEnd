import{_ as k}from"./DpAIBldb.js";import{e as C,u as V,r as p,k as E,p as S,q as A,s as T,f as P,c as g,o as h,b as c,a as n,w,g as I,h as l,v as a,x as U,j as B}from"./Dq_m8wUf.js";import{_ as N}from"./DWSRSFXG.js";import{u as j}from"./BLm3UM3d.js";import{g as x,s as L}from"./B9D70_wx.js";import{L as R}from"./lrz6IDt1.js";const q={class:"p-5 md:p-10 min-h-screen"},z={class:"w-full md:w-[600px] card shadow-md mt-20 px-3 mx-auto flex items-center h-full"},D={class:"w-[600px] p-2"},M={class:"relative mt-5 p-5 pb-10 rounded-lg"},O={class:""},F={class:"grid grid-cols-6 gap-4 w-full md:w-[70%] items-center mx-auto justify-center",style:{}},$={class:"flex w-full mt-10"},H=["disabled"],Y={key:0},tt=C({__name:"otp-verify",setup(Z){const d=V();j();const u=p(!1),m=p(!1);E(),p("password"),p(!1);const e=S({input1:"",input2:"",input3:"",input4:"",input5:"",input6:""}),f=A(()=>e.input1!==""&&e.input2!==""&&e.input3!==""&&e.input4!==""&&e.input5!==""&&e.input6!==""),y=()=>{e.input1=="",e.input2=="",e.input3=="",e.input4=="",e.input5=="",e.input6==""};setTimeout(()=>{const s=document.getElementsByClassName("pin");Array.from(s).forEach((t,i)=>{t.addEventListener("keyup",r=>{r.keyCode===6&&i>0&&t.previousElementSibling.focus(),t.value.length==1&&i<5&&r.keyCode!==8&&t.nextElementSibling.focus(),r.keyCode===8&&i>0&&t.previousElementSibling.focus(),i<6&&console.log("input",b())})})},1e3);const b=()=>e.input1+e.input2+e.input3+e.input4+e.input5+e.input6,v=async()=>{var t,i;u.value=!0;const s=await $fetch("/api/auth/otp",{method:"PATCH",query:{type:"verify-account"},body:{otp:b(),email:x().email}});s.error?(d.error(s.error.message||"An error occured: Please try again"),u.value=!1):(L.set("sessionData",{access_token:(t=s==null?void 0:s.data)==null?void 0:t.access_token}),y(),d.success((i=s==null?void 0:s.data)==null?void 0:i.message),window.location.href="/user",u.value=!1)},_=async()=>{var t;m.value=!0;const s=await $fetch("/api/auth/otp",{method:"POST",query:{type:"resend-otp"},body:{email:x().email}});s.error?(d.error(s.error.message||"An error occured: Please try again"),m.value=!1):(m.value=!1,d.success(((t=s==null?void 0:s.data)==null?void 0:t.message)||"Email sent successfully"))};return T(()=>{console.log(x().email)}),(s,t)=>{const i=k,r=P("router-link");return h(),g("section",q,[c(i,{to:"/"},{default:w(()=>t[7]||(t[7]=[n("div",{class:"flex gap-2 items-center"},[n("img",{src:N,alt:""}),n("h1",{class:"text-xl font-extrabold text-black"},"ISZIFY")],-1)])),_:1}),n("div",z,[n("div",D,[c(r,{to:"/"},{default:w(()=>t[8]||(t[8]=[n("div",{class:"flex gap-1 items-center text-accent hover:text-primary"},[n("ion-icon",{name:"chevron-back-outline",size:"small"}),n("span",null,"Back")],-1)])),_:1}),n("div",M,[t[12]||(t[12]=n("div",{class:"mt-5 md:mt-10"},[n("h3",{class:"text-center text-2xl text-primary font-bold"}," OTP VERIFICATION "),n("h4",{class:"text-sm md:text-base 2xl:text-lg pt-5 font-bold my-4 text-center"}," Enter the otp code sent to your email to verify your account ")],-1)),n("div",O,[n("form",{onSubmit:t[6]||(t[6]=I(()=>{},["prevent"])),class:""},[n("div",null,[t[11]||(t[11]=n("label",{class:"text-xs md:text-sm 2xl:text-lg mb-8 text-grey-shades flex justify-center"},"Please enter your token code",-1)),n("div",F,[l(n("input",{type:"text",tabindex:"1",maxlength:"1",id:"basic_old1","onUpdate:modelValue":t[0]||(t[0]=o=>e.input1=o),class:"pin md:w-12 md:h-12 xs:w-10 p-0 xs:h-10 w-8 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input1]]),l(n("input",{type:"text",tabindex:"2",maxlength:"1",id:"basic_old2","onUpdate:modelValue":t[1]||(t[1]=o=>e.input2=o),class:"pin md:w-12 md:h-12 xs:w-10 xs:h-10 p-0 w-8 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input2]]),l(n("input",{type:"text",maxlength:"1",tabindex:"3",id:"basic_old3","onUpdate:modelValue":t[2]||(t[2]=o=>e.input3=o),class:"pin md:w-12 md:h-12 xs:w-10 xs:h-10 w-8 p-0 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input3]]),l(n("input",{type:"text",maxlength:"1",tabindex:"4",id:"basic_old4","onUpdate:modelValue":t[3]||(t[3]=o=>e.input4=o),class:"pin md:w-12 md:h-12 xs:w-10 xs:h-10 p-0 w-8 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input4]]),l(n("input",{type:"text",maxlength:"1",tabindex:"5",id:"basic_old5","onUpdate:modelValue":t[4]||(t[4]=o=>e.input5=o),class:"pin md:w-12 md:h-12 xs:w-10 xs:h-10 p-0 w-8 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input5]]),l(n("input",{type:"text",maxlength:"1",tabindex:"5",id:"basic_old6","onUpdate:modelValue":t[5]||(t[5]=o=>e.input6=o),class:"pin md:w-12 md:h-12 xs:w-10 xs:h-10 p-0 w-8 h-8 rounded-lg border border-accent text-center font-bold text-2xl bg-white"},null,512),[[a,e.input6]])]),n("div",$,[n("button",{disabled:!f.value,onClick:v,class:U(["w-full rounded-md text-white md:h-10 h-8 text-sm md:text-base font-bold p-2 border-0 focus:bg-info-shades flex justify-center items-center gap-2",f.value?"bg-info hover:bg-info-tint hover:text-info cursor-pointer":"bg-accent-shades cursor-not-allowed"]),type:"button"},[u.value?(h(),g("span",Y,[c(R,{color:"info"})])):B("",!0),t[9]||(t[9]=n("span",null,"Proceed",-1))],10,H)]),n("div",{class:"text-center mt-5 text-xs md:text-sm 2xl:text-base"},[t[10]||(t[10]=n("span",null,"Click the resend button if you did not get Token",-1)),n("button",{class:"font-bold underline text-sm md:text-base underline-offset-1 ml-2 cursor-pointer hover:text-primary text-success",onClick:_}," Resend ")])])],32)])])])])])}}});export{tt as default};
